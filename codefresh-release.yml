version: '1.0'

steps:

  build_executables:
    title: "Building executables"
    image: node:9.2.0
    commands:
      - "apt-get install zip"
      - "yarn install"
      - "yarn global add pkg"
      - "pkg ."
      - "zip codefresh-linux codefresh-linux"
      - "zip codefresh-macos codefresh-macos"
      - "zip codefresh-windows codefresh-windows.exe"
      #- 'curl -i -X GET https://api.github.com/repo/codefresh-io/codefresh/releases/tags/${{CF_BRANCH}}'
      - 'curl -X POST -H "Content-Type:application/octet-stream" -H "Authorization: token ${{TOKEN}}"  --data-binary @codefresh-macos.zip https://uploads.github.com/repos/codefresh-io/codefresh/releases/9048401/assets?name=codefresh-macos.zip'
      - 'curl -X POST -H "Content-Type:application/octet-stream" -H "Authorization: token ${{TOKEN}}"  --data-binary @codefresh-linux.zip https://uploads.github.com/repos/codefresh-io/codefresh/releases/9048401/assets?name=codefresh-linux.zip'
      - 'curl -X POST -H "Content-Type:application/octet-stream" -H "Authorization: token ${{TOKEN}}"  --data-binary @codefresh-windows.zip https://uploads.github.com/repos/codefresh-io/codefresh/releases/9048401/assets?name=codefresh-windows.zip'


## add to npm
